@Description
This is a display of 2 trips (one starting its journey before and other other after midnight).
SEPTA uses the Level-2 date matching algorithm (-l 2) for real time trip updates, so no date
comparison can be made (service vs. actual or otherwise) since it is not published with their
realtime updates. They also use an older style of predictions where only the next stop is
published with an offset, the remaining stops in a trip are assumed to have the same offset.
@End

@StartParams
-ctrips_before_and_after_midnight.ini
-f2020,5,22,0,30,30
@End

@Case:Assert Running and Expected Records Loaded
@Query:SDS
@Expected
{
    "agencies": [
        {
            "id": "SEPTA",
            "lang": "EN",
            "name": "SEPTA",
            "phone": "noreply@septa.org",
            "tz": "America/New_York",
            "url": "http://www.septa.org"
        }
    ],
    "application": "GtfsProc 2.5.0",
*   "appuptime_sec": 9,
*   "dataloadtime_ms": 8,
    "error": 0,
    "feed_lang": "EN",
    "feed_publisher": "SEPTA",
    "feed_url": "http://www.septa.org",
    "feed_valid_end": "30-May-2020",
    "feed_valid_start": "10-May-2020",
    "feed_version": "Mon May  4 16:45:34 UTC 2020",
    "hide_terminating": false,
    "message_time": "22-May-2020 00:30:30 EDT",
    "message_type": "SDS",
    "nb_nex_trips": 4,
    "overrides": "",
*   "proc_time_ms": 0,
*   "processed_reqs": 2,
    "records": 2476,
    "rt_date_match": 2,
    "rt_trip_seq_match": true,
    "threadpool_count": 1
}
@End

@Case:Realtime Data Integrated and Active
@Query:RDS
@Expected
{
*   "active_age_sec": 28,
*   "active_download_ms": 34,
    "active_feed_time": "22-May-2020 00:30:02 EDT",
*   "active_integration_ms": 0,
    "active_rt_version": "1.0",
    "active_side": "A",
    "error": 0,
*   "last_realtime_query": "24-Feb-2021 17:36:42 EST",
    "message_time": "22-May-2020 00:30:30 EDT",
    "message_type": "RDS",
*   "proc_time_ms": 0,
*   "seconds_to_next_fetch": 587
}
@End

@Case:Trip starting before midnight:  LAN_578_V26_M
@Query:NCF 120 90530
@Expected
{
    "error": 0,
    "message_time": "22-May-2020 00:30:30 EDT",
    "message_type": "NCF",
*   "proc_time_ms": *****,
    "realtime_age_sec": 28,
*   "static_data_modif": "22-May-2020 22:33:48 EDT",
    "stop_desc": "Parent Station",
    "stop_id": "90530",
    "stop_name": "Pennbrook",
    "trips": [
        {
            "arr_time": "Fri 00:32",
            "dep_time": "Fri 00:32",
            "drop_off_type": 0,
            "headsign": "Lansdale",
            "interp": false,
            "pickup_type": 0,
            "realtime_data": {
                "actual_arrival": "Fri 00:32",
                "actual_departure": "Fri 00:32",
                "offset_seconds": 0,
                "status": "RNNG",
                "stop_status": "FULL",
                "vehicle": ""
            },
            "route_id": "LAN",
            "short_name": "578",
            "stop_id": "90530",
            "trip_begins": false,
            "trip_id": "LAN_578_V26_M",
            "trip_terminates": false,
            "wait_time_sec": 90
        }
    ]
}
@End

@Case:Trip starting after midnight:   PAO_575_V25_M
@Query:NCF 120 90521
@Expected
{
    "error": 0,
    "message_time": "22-May-2020 00:30:30 EDT",
    "message_type": "NCF",
*   "proc_time_ms": *****,
    "realtime_age_sec": 28,
*   "static_data_modif": "22-May-2020 22:33:48 EDT",
    "stop_desc": "Parent Station",
    "stop_id": "90521",
    "stop_name": "Merion",
    "trips": [
        {
            "arr_time": "Fri 00:46",
            "dep_time": "Fri 00:46",
            "drop_off_type": 0,
            "headsign": "Malvern",
            "interp": false,
            "pickup_type": 0,
            "realtime_data": {
                "actual_arrival": "Fri 00:46",
                "actual_departure": "Fri 00:46",
                "offset_seconds": 0,
                "status": "RNNG",
                "stop_status": "FULL",
                "vehicle": ""
            },
            "route_id": "PAO",
            "short_name": "575",
            "stop_id": "90521",
            "trip_begins": false,
            "trip_id": "PAO_575_V25_M",
            "trip_terminates": false,
            "wait_time_sec": 930
        }
    ]
}
@End

@Case:List of trips on routes with realtime information
@Query TRR PAO|LAN|WAR
@Expected
{
    "error": 0,
    "message_time": "22-May-2020 00:30:30 EDT",
    "message_type": "TRR",
*   "proc_time_ms": 1,
    "realtime_age_sec": 28,
    "routes": [
        {
            "color": "20825C",
            "route_id": "PAO",
            "route_long_name": "Paoli/Thorndale Line",
            "route_short_name": "Paoli/Thorndale Line",
            "text_color": "FFFFFF",
            "trips": [
                {
                    "arrive": "00:31",
                    "depart": "00:31",
                    "direction_id": 103,
                    "drop_off_type": 0,
                    "headsign": "Malvern",
                    "next_stop_id": "90005",
                    "next_stop_name": "Suburban Station",
                    "next_stop_parent": "90005",
                    "pickup_type": 0,
                    "rt_start_date": "-",
                    "short_name": "575",
                    "skipped": false,
                    "trip_id": "PAO_575_V25_M",
                    "vehicle": ""
                }
            ]
        },
        {
            "color": "775B49",
            "route_id": "LAN",
            "route_long_name": "Lansdale/Doylestown Line",
            "route_short_name": "Lansdale/Doylestown Line",
            "text_color": "FFFFFF",
            "trips": [
                {
                    "arrive": "00:32",
                    "depart": "00:32",
                    "direction_id": 103,
                    "drop_off_type": 0,
                    "headsign": "Lansdale",
                    "next_stop_id": "90530",
                    "next_stop_name": "Pennbrook",
                    "next_stop_parent": "90530",
                    "pickup_type": 0,
                    "rt_start_date": "-",
                    "short_name": "578",
                    "skipped": false,
                    "trip_id": "LAN_578_V26_M",
                    "vehicle": ""
                }
            ]
        },
        {
            "color": "F7AF42",
            "route_id": "WAR",
            "route_long_name": "Warminster Line",
            "route_short_name": "Warminster Line",
            "text_color": "FFFFFF",
            "trips": [
                {
                    "arrive": "00:31",
                    "depart": "00:31",
                    "direction_id": 103,
                    "drop_off_type": 0,
                    "headsign": "Warminster",
                    "next_stop_id": "90407",
                    "next_stop_name": "Fern Rock T C",
                    "next_stop_parent": "90407",
                    "pickup_type": 0,
                    "rt_start_date": "-",
                    "short_name": "474",
                    "skipped": false,
                    "trip_id": "WAR_474_V25_M",
                    "vehicle": ""
                }
            ]
        }
    ]
}
@End
